Re-write sort function, add weights
Add buttons: "expand all", "collapse all"
