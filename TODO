Re-write sort function, add weights
